var Rt=(n,s,t)=>{if(!s.has(n))throw TypeError("Cannot "+t)};var d=(n,s,t)=>{if(s.has(n))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(n):s.set(n,t)};var r=(n,s,t)=>(Rt(n,s,"access private method"),t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const h of e.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?e.credentials="include":o.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(o){if(o.ep)return;o.ep=!0;const e=t(o);fetch(o.href,e)}})();let c,R,V;const q=["mousemove","click","hover","mouseover","mouseleave"];var O,z,b,L;const rt=class{constructor(s,t,i=0){d(this,O);d(this,b);this.x=s,this.y=t,this.mag=ht(s,t),this.startAngle=vt(Ct(t,s)),this.startX=s,this.startY=t,this.rotation=i,r(this,O,z).call(this)}rotate(s){return this.rotation+=s,r(this,O,z).call(this),this}rotateTo(s){return this.rotation=s,r(this,O,z).call(this),this}draw(s,t=new f(0,0),i=new u(0,0,0),o=1){s.beginPath(),s.strokeStyle=i.toHex(),s.lineWidth=o,s.moveTo(t.x,t.y),s.lineTo(t.x+this.x,t.y+this.y),s.stroke(),s.closePath()}normalize(){return this.mag!=0&&(this.x/=this.mag,this.startX/=this.mag,this.y/=this.mag,this.startY/=this.mag,this.mag=1),this}multiply(s){return this.x*=s,this.startX*=s,this.y*=s,this.startY*=s,this.mag*=s,this}add(s){return this.x+=s.x,this.startX+=s.x,this.y+=s.x,this.startY+=s.x,r(this,b,L).call(this),this}multiplyX(s){return this.x*=s,this.startX*=s,r(this,b,L).call(this),this}multiplyY(s){return this.y*=s,this.startY*=s,r(this,b,L).call(this),this}divide(s){return this.x/=s,this.startX/=s,this.y/=s,this.startY/=s,this.mag/=s,this}appendMag(s){if(this.mag!=0){const t=this.mag+s;this.normalize(),this.multiply(t),this.mag=t}return this}appendX(s){return this.x+=s,this.startX+=s,r(this,b,L).call(this),this}appendY(s){return this.y+=s,this.startY+=s,r(this,b,L).call(this),this}setX(s){return this.x=s,this.startX=s,r(this,b,L).call(this),this}setY(s){return this.y=s,this.startY=s,r(this,b,L).call(this),this}setMag(s){return this.normalize(),this.multiply(s),this.mag=s,this}clone(){return new rt(this.x,this.y,this.rotation)}format(){return`(${this.x}, ${this.y})`}};let w=rt;O=new WeakSet,z=function(){this.rotation=S(this.rotation);const s=this.rotation*(Math.PI/180);this.x=this.startX*Math.cos(s)-this.startY*Math.sin(s),this.y=this.startX*Math.sin(s)+this.startY*Math.cos(s)},b=new WeakSet,L=function(){this.mag=ht(this.x,this.y)};class M{constructor(s,t=new u(0,0,0)){this.pos=s,this.color=t,this.sim=null}setSimulationElement(s){this.sim=s}fill(s,t=0){const i=new u(this.color.r,this.color.g,this.color.b),o=s.clone(),e=(o.r-this.color.r)/(t*c),h=(o.g-this.color.g)/(t*c),a=(o.b-this.color.b)/(t*c),l=()=>{this.color=o};return g(l,()=>{i.r+=e,i.g+=h,i.b+=a,this.color.r=i.r,this.color.g=i.g,this.color.b=i.b},l,t)}moveTo(s,t=0){const i=(s.x-this.pos.x)/(t*c),o=(s.y-this.pos.y)/(t*c);return g(()=>{this.pos=s},()=>{this.pos.x+=i,this.pos.y+=o},()=>{this.pos.x=s.x,this.pos.y=s.y},t)}move(s,t=0){const i=s.x/(t*c),o=s.y/(t*c),e=new f(this.pos.x,this.pos.y);return g(()=>{this.pos.x+=s.x,this.pos.y+=s.y},()=>{this.pos.x+=i,this.pos.y+=o},()=>{this.pos.x=e.x+s.x,this.pos.y=e.y+s.y},t)}}var T,A;const at=class{constructor(s,t,i){d(this,T);this.r=s,this.g=t,this.b=i}clone(){return new at(this.r,this.g,this.b)}toHex(){return"#"+r(this,T,A).call(this,this.r)+r(this,T,A).call(this,this.g)+r(this,T,A).call(this,this.b)}};let u=at;T=new WeakSet,A=function(s){const t=Math.round(s).toString(16);return t.length==1?"0"+t:t};class f extends w{constructor(s,t){super(s,t)}clone(){return new f(this.x,this.y)}}class Lt extends M{constructor(s=""){super(new f(0,0)),this.name=s,this.scene=[],this.idObjs={}}add(s,t=null){s instanceof M?(this.sim!=null&&s.setSimulationElement(this.sim),t!=null?this.idObjs[t]=s:this.scene.push(s)):console.warn("Invalid Element. Must be an instance of SimElement")}removeWithId(s){delete this.idObjs[s]}removeWithObject(s){for(const t of this.scene)if(t==s){this.scene.splice(this.scene.indexOf(t),1);return}for(const t of Object.keys(this.idObjs))if(this.idObjs[t]==s){delete this.idObjs[t];return}}setSimulationElement(s){this.sim=s;for(const t of this.scene)t.setSimulationElement(s)}draw(s){for(const t of this.scene)t.draw(s);for(const t of Object.values(this.idObjs))t.draw(s)}empty(){this.scene=[],this.idObjs={}}}var v,k;const ct=class extends M{constructor(t,i,o=new u(0,0,0),e=1,h=0){super(t,o);d(this,v);this.start=t,this.end=i,this.rotation=h,this.thickness=e,r(this,v,k).call(this)}clone(){return new ct(this.start,this.end,this.thickness,this.color,this.rotation)}setStart(t,i=0){const o=(t.x-this.start.x)/(i*c),e=(t.y-this.start.y)/(i*c);return g(()=>{this.start=t},()=>{this.start.x+=o,this.start.y+=e},()=>{this.start=t},i)}setEnd(t,i=0){const o=(t.x-this.end.x)/(i*c),e=(t.y-this.end.y)/(i*c);return g(()=>{this.end=t,r(this,v,k).call(this)},()=>{this.end.x+=o,this.end.y+=e,r(this,v,k).call(this)},()=>{this.end=t,r(this,v,k).call(this)},i)}rotate(t,i=0){const o=t/(i*c),e=this.rotation;return g(()=>{this.rotation+=t,this.vec.rotate(t)},()=>{this.rotation+=o,this.vec.rotate(o)},()=>{this.rotation=e+t,this.rotation=S(this.rotation)},i)}rotateTo(t,i=0){const o=(t-this.rotation)/(i*c);return g(()=>{this.rotation=t,this.vec.rotateTo(t)},()=>{this.rotation+=o,this.vec.rotateTo(this.rotation)},()=>{this.rotation=t,this.rotation=S(this.rotation),this.vec.rotateTo(t)},i)}moveTo(t,i=0){return this.setStart(t,i)}move(t,i=0){return this.moveTo(this.start.add(t),i)}draw(t){this.vec.draw(t,new f(this.start.x,this.start.y),this.color,this.thickness)}};let _=ct;v=new WeakSet,k=function(){this.vec=new w(this.end.x-this.start.x,this.end.y-this.start.y),this.vec.rotateTo(this.rotation)};var K,ut;const ft=class extends M{constructor(t,i,o){super(t,o);d(this,K);this.radius=i,this.hovering=!1,this.events=[]}clone(){return new ft(this.pos,this.radius,this.color)}draw(t){t.beginPath(),t.fillStyle=this.color.toHex(),t.arc(this.pos.x,this.pos.y,this.radius,0,Math.PI*2,!1),t.fill(),t.closePath(),r(this,K,ut).call(this)}setRadius(t,i=0){const o=(t-this.radius)/(i*c);return g(()=>{this.radius=t},()=>{this.radius+=o},()=>{this.radius=t},i)}scale(t,i=0){const o=(this.radius*t-this.radius)/(i*c),e=this.radius*t;return g(()=>{this.radius=e},()=>{this.radius+=o},()=>{this.radius=e},i)}on(t,i,o){if(!q.includes(t)){console.warn(`Invalid event: ${t}. Event must be one of ${q.join(", ")}`);return}if(t==="mousemove")this.sim.addEventListener("mousemove",e=>{const h=new f(e.offsetX,e.offsetY);this.contains(h)&&i(e)});else if(t==="hover")this.on("mouseover",i),this.on("mouseleave",o);else if(t==="click")this.sim.addEventListener("click",e=>{const h=new f(e.clientX,e.clientY);this.contains(h)&&i(e)});else{const e=new pt(t,i);this.events.push(e)}}contains(t){return Yt(t,this.pos)<this.radius}};let tt=ft;K=new WeakSet,ut=function(){this.events.forEach(t=>{switch(t.name){case"mouseover":{!this.hovering&&R&&this.contains(R)&&(this.hovering=!0,t.callback(V));break}case"mouseleave":{this.hovering&&R&&!this.contains(R)&&(this.hovering=!1,t.callback(V));break}}})};var j,W;const lt=class extends M{constructor(t,i,o,e=0,h=new f(0,0)){super(t,o);d(this,j);this.rawPoints=i,this.offsetPoint=h,this.offsetX=this.offsetPoint.x,this.offsetY=this.offsetPoint.y,this.points=i.map(a=>new f(a.x+this.offsetX,a.y+this.offsetY)),this.rotation=e,r(this,j,W).call(this)}setPoints(t){this.points=t.map(i=>new f(i.x+this.offsetX,i.y+this.offsetY))}clone(){return new lt(this.pos,this.rawPoints,this.color,this.rotation,this.offsetPoint)}rotate(t){this.rotation+=t,r(this,j,W).call(this)}rotateTo(t){this.rotation=t,r(this,j,W).call(this)}draw(t){t.beginPath(),t.fillStyle=this.color.toHex(),t.moveTo(this.points[0].x+this.pos.x,this.points[0].y+this.pos.y);for(let i=1;i<this.points.length;i++)t.lineTo(this.points[i].x+this.pos.x,this.points[i].y+this.pos.y);t.fill(),t.closePath()}};let st=lt;j=new WeakSet,W=function(){this.rotation=S(this.rotation),this.points=this.points.map(t=>(t.rotateTo(this.rotation),t))};class pt{constructor(s,t){this.name=s,this.callback=t}}var X,E,B,dt,I,ot,x,C,D,gt;const mt=class extends M{constructor(t,i,o,e,h=new f(0,0),a=0){super(t,e);d(this,X);d(this,B);d(this,I);d(this,x);d(this,D);this.width=i,this.height=o,this.rotation=a,this.showNodeVectors=!1,this.showCollisionVectors=!1,this.hovering=!1,this.events=[],this.updateOffsetPosition(h)}updateOffsetPosition(t){this.offsetX=t.x,this.offsetY=t.y,this.topLeft=new w(-this.width/2-this.offsetX,-this.height/2-this.offsetY),this.topRight=new w(this.width/2-this.offsetX,-this.height/2-this.offsetY),this.bottomLeft=new w(-this.width/2-this.offsetX,this.height/2-this.offsetY),this.bottomRight=new w(this.width/2-this.offsetX,this.height/2-this.offsetY),r(this,X,E).call(this)}setNodeVectors(t){this.showNodeVectors=t}setCollisionVectors(t){this.showCollisionVectors=t}rotate(t,i=0){const o=this.rotation,e=t/(i*c),h=()=>{this.rotation=o+t,this.rotation=S(this.rotation),r(this,X,E).call(this)};return g(h,()=>{this.rotation+=e,r(this,X,E).call(this)},h,i)}rotateTo(t,i=0){const o=(t-this.rotation)/(i*c),e=()=>{this.rotation=t,this.rotation=S(this.rotation),r(this,X,E).call(this)};return g(e,()=>{this.rotation+=o,r(this,X,E).call(this)},e,i)}draw(t){if(t.beginPath(),t.fillStyle=this.color.toHex(),t.moveTo(this.pos.x+this.topLeft.x+this.offsetX,this.pos.y+this.topLeft.y+this.offsetY),t.lineTo(this.pos.x+this.topRight.x+this.offsetX,this.pos.y+this.topRight.y+this.offsetY),t.lineTo(this.pos.x+this.bottomRight.x+this.offsetX,this.pos.y+this.bottomRight.y+this.offsetY),t.lineTo(this.pos.x+this.bottomLeft.x+this.offsetX,this.pos.y+this.bottomLeft.y+this.offsetY),t.fill(),t.closePath(),this.showNodeVectors&&(this.topLeft.draw(t,new f(this.pos.x+this.offsetX,this.pos.y+this.offsetY)),this.topRight.draw(t,new f(this.pos.x+this.offsetX,this.pos.y+this.offsetY)),this.bottomLeft.draw(t,new f(this.pos.x+this.offsetX,this.pos.y+this.offsetY)),this.bottomRight.draw(t,new f(this.pos.x+this.offsetX,this.pos.y+this.offsetY))),this.showCollisionVectors){const i=[this.v1,this.v2,this.v3,this.v4,this.v5];i.some(o=>o)&&i.forEach(o=>o.draw(t,new f(this.pos.x,this.pos.y),new u(0,0,255)))}r(this,D,gt).call(this)}scale(t,i=0){const o=this.topRight.mag,e=this.topLeft.mag,h=this.bottomRight.mag,a=this.bottomLeft.mag,l=(o*t-o)/(i*c),p=(e*t-e)/(i*c),y=(h*t-h)/(i*c),m=(a*t-a)/(i*c);return g(()=>{this.topRight.multiply(t),this.topLeft.multiply(t),this.bottomRight.multiply(t),this.bottomLeft.multiply(t),r(this,x,C).call(this)},()=>{this.topRight.appendMag(l),this.topLeft.appendMag(p),this.bottomRight.appendMag(y),this.bottomLeft.appendMag(m)},()=>{this.topRight.normalize(),this.topRight.multiply(o*t),this.topLeft.normalize(),this.topLeft.multiply(e*t),this.bottomRight.normalize(),this.bottomRight.multiply(h*t),this.bottomLeft.normalize(),this.bottomLeft.multiply(a*t),r(this,x,C).call(this)},i)}scaleWidth(t,i=0){let{topRightClone:o,topLeftClone:e,bottomRightClone:h,bottomLeftClone:a,topRightMag:l,topLeftMag:p,bottomRightMag:y,bottomLeftMag:m}=r(this,I,ot).call(this,"x");const U=(l*t-l)/(i*c),J=(p*t-p)/(i*c),Q=(y*t-y)/(i*c),Z=(m*t-m)/(i*c);return g(()=>{this.topRight.multiplyX(t),this.topLeft.multiplyX(t),this.bottomRight.multiplyX(t),this.bottomLeft.multiplyX(t),r(this,x,C).call(this)},()=>{this.topRight.appendX(U),this.topLeft.appendX(J),this.bottomRight.appendX(Q),this.bottomLeft.appendX(Z)},()=>{o.setX(1),o.multiplyX(l*t),this.topRight=o.clone(),e.setX(1),e.multiplyX(p*t),this.topLeft=e.clone(),h.setX(1),h.multiplyX(y*t),this.bottomRight=h.clone(),a.setX(1),a.multiplyX(m*t),this.bottomLeft=a.clone(),r(this,x,C).call(this)},i)}scaleHeight(t,i=0){let{topRightClone:o,topLeftClone:e,bottomLeftClone:h,bottomRightClone:a,topRightMag:l,topLeftMag:p,bottomRightMag:y,bottomLeftMag:m}=r(this,I,ot).call(this,"y");const U=(l*t-l)/(i*c),J=(p*t-p)/(i*c),Q=(y*t-y)/(i*c),Z=(m*t-m)/(i*c);return g(()=>{this.topRight.multiplyY(t),this.topLeft.multiplyY(t),this.bottomRight.multiplyY(t),this.bottomLeft.multiplyY(t),r(this,x,C).call(this)},()=>{this.topRight.appendY(U),this.topLeft.appendY(J),this.bottomRight.appendY(Q),this.bottomLeft.appendY(Z)},()=>{o.setY(1),o.multiplyY(l*t),this.topRight=o.clone(),e.setY(1),e.multiplyY(p*t),this.topLeft=e.clone(),a.setY(1),a.multiplyY(y*t),this.bottomRight=a.clone(),h.setY(1),h.multiplyY(m*t),this.bottomLeft=h.clone(),r(this,x,C).call(this)},i)}setWidth(t,i=0){const o=t/this.width;return this.scaleWidth(o,i)}setHeight(t,i=0){const o=t/this.height;return this.scaleHeight(o,i)}contains(t){const i=new w(this.topLeft.x,this.topLeft.y);i.rotateTo(-this.rotation),this.v1=i;const o=new w(this.topRight.x,this.topRight.y);o.rotateTo(-this.rotation),this.v2=o;const e=new w(this.bottomLeft.x,this.bottomLeft.y);e.rotateTo(-this.rotation),this.v3=e;const h=new w(this.bottomRight.x,this.bottomRight.y);h.rotateTo(-this.rotation),this.v4=h;const a=new w(t.x-this.pos.x-this.offsetX,t.y-this.pos.y-this.offsetY);return a.rotateTo(-this.rotation),this.v5=a,a.x>e.x&&a.x<o.x&&a.y>i.y&&a.y<e.y}on(t,i,o){if(!q.includes(t)){console.warn(`Invalid event: ${t}. Event must be one of ${q.join(", ")}`);return}if(t==="mousemove")this.sim.addEventListener("mousemove",e=>{const h=new f(e.clientX,e.clientY);this.contains(h)&&i(e)});else if(t==="click")this.sim.addEventListener("click",e=>{const h=new f(e.clientX,e.clientY);this.contains(h)&&i(e)});else if(t==="hover")this.on("mouseover",i),this.on("mouseleave",o);else{const e=new pt(t,i);this.events.push(e)}}clone(){return new mt(this.pos,this.width,this.height,this.color,this.offsetPoint,rotation)}};let it=mt;X=new WeakSet,E=function(){this.topLeft.rotateTo(this.rotation),this.topRight.rotateTo(this.rotation),this.bottomLeft.rotateTo(this.rotation),this.bottomRight.rotateTo(this.rotation)},B=new WeakSet,dt=function(){const t=this.topRight.clone(),i=this.topLeft.clone(),o=this.bottomLeft.clone(),e=this.bottomRight.clone();return{topRightClone:t,topLeftClone:i,bottomLeftClone:o,bottomRightClone:e}},I=new WeakSet,ot=function(t){const i=r(this,B,dt).call(this),o=Object.keys(i).reduce((e,h,a)=>{let l={...e};return t?l[h.replace("Clone","Mag")]=i[h][t]:l[h.replace("Clone","Mag")]=h.mag,l},{});return{...i,...o}},x=new WeakSet,C=function(){this.height=this.topRight.y+this.bottomRight.y,this.width=this.topRight.x+this.topLeft.x},D=new WeakSet,gt=function(){this.events.forEach(t=>{switch(t.name){case"mouseover":{!this.hovering&&R&&this.contains(R)&&(this.hovering=!0,t.callback(V));break}case"mouseleave":{this.hovering&&R&&!this.contains(R)&&(this.hovering=!1,t.callback(V));break}}})};var H,et,P,N;class Xt{constructor(s,t=60){d(this,H);d(this,P);if(c=t,this.scene=[],this.idObjs={},this.fitting=!1,this.bgColor="#ffffff",this.canvas=document.getElementById(s),!this.canvas){console.warn(`Canvas with id "${s}" not found`);return}this.canvas.addEventListener("mousemove",o=>{R=new f(o.offsetX,o.offsetY),V=o}),window.addEventListener("resize",()=>r(this,P,N).call(this,this.canvas)),r(this,P,N).call(this,this.canvas);const i=this.canvas.getContext("2d");r(this,H,et).call(this,i)}add(s,t=null){s instanceof M?(s.setSimulationElement(this.canvas),t!==null?this.idObjs[t]=s:this.scene.push(s)):console.warn("Invalid Element. Must be an instance of SimElement")}removeWithId(s){this.idObjs[s]!==void 0&&delete this.idObjs[s]}removeWithObject(s){for(const t of this.scene)if(F(t,s)){this.scene.splice(this.scene.indexOf(t),1);return}for(const t of Object.keys(this.idObjs))F(this.idObjs[t],s)&&delete this.idObjs[t]}on(s,t){!this.canvas||this.canvas.addEventListener(s,t)}fitElement(){!this.canvas||(this.fitting=!0,r(this,P,N).call(this,this.canvas))}setSize(s,t){!this.canvas||(this.canvas.width=s,this.canvas.height=t,this.fitting=!1)}setBgColor(s){s instanceof u?this.bgColor=s.toHex():console.warn("Invalid color. Must be an instance of Color object")}empty(){this.scene=[],this.idObjs={}}}H=new WeakSet,et=function(s){s.clearRect(0,0,this.canvas.width,this.canvas.height),s.beginPath(),s.fillStyle=this.bgColor,s.fillRect(0,0,this.canvas.width,this.canvas.height),s.closePath();for(const t of this.scene)t.draw(s);Object.values(this.idObjs).forEach(t=>{t.draw(s)}),window.requestAnimationFrame(()=>r(this,H,et).call(this,s))},P=new WeakSet,N=function(s){!this.canvas||(this.fitting&&(s.width=s.parentElement.clientWidth,s.height=s.parentElement.clientHeight),this.width=this.canvas.width,this.height=this.canvas.height)};function ht(n,s){return Math.sqrt(Math.pow(n,2)+Math.pow(s,2))}function Yt(n,s){return ht(n.x-s.x,n.y-s.y)}function Ct(n,s){return Math.atan2(s,n)}function vt(n){return n*180/Math.PI}function S(n){for(;n>360;)n-=360;return n}function g(n,s,t,i){return new Promise((o,e)=>{if(i==0)n(),o();else{const h=i*c;let a=0;const l=()=>{s(),a<h?(a++,window.requestAnimationFrame(l)):(t(),o())};window.requestAnimationFrame(l)}})}function F(n,s){const t=[null,void 0];if(t.includes(n)||t.includes(s))return n===s;if(typeof n!=typeof s)return!1;if(Array.isArray(n)){for(let i=0;i<n.length;i++)if(!F(n[i],s[i]))return!1;return!0}if(typeof n=="object"){const i=(l,p,y)=>{for(let m=0;m<l.length;m++){if(typeof p[l[m]]!=typeof y[l[m]])return!1;if(typeof p[l[m]]=="object")return F(p[l[m]],y[l[m]]);if(p[l[m]]!==y[l[m]])return!1}return!0},o=Object.keys(n),e=Object.keys(s),h=i(o,n,s),a=i(e,n,s);return!!(h&&a)}return n===s}const G=new Xt("canvas");G.fitElement();const nt=new Lt;G.add(nt);const $=new tt(new f(150,150),50,new u(0,0,255));nt.add($);const Y=new it(new f(400,500),100,200,new u(255,0,0),new f(50,100));nt.add(Y,"sq");const yt=new st(new f(600,600),[new f(0,0),new f(100,0),new f(100,200),new f(0,100)],new u(0,255,0));G.add(yt);const wt=new _(new f(100,100),new f(0,0),new u(0,255,255),4);G.add(wt);Y.on("hover",()=>{Y.fill(new u(0,255,0),.15)},()=>{Y.fill(new u(255,0,0),.15)});Y.setNodeVectors(!0);async function Mt(){await Y.scaleWidth(2,1),await Y.scaleHeight(2,2);async function n(){setTimeout(()=>{Y.rotate(.5),n()},1e3/64)}n()}Mt();async function bt(){await $.fill(new u(0,255,0),1),await $.fill(new u(0,0,255),1),await $.fill(new u(255,0,0),1),bt()}bt();function xt(){setTimeout(()=>{yt.rotate(2),wt.rotate(2),xt()},1e3/60)}xt();
