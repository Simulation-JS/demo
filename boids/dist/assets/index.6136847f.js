var dt=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var M=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)};var a=(e,t,s)=>(dt(e,t,"access private method"),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const u of h.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerpolicy&&(h.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?h.credentials="include":o.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function i(o){if(o.ep)return;o.ep=!0;const h=s(o);fetch(o.href,h)}})();let y;var Y,F,p,v;const it=class{constructor(t,s,i=0){M(this,Y);M(this,p);this.x=t,this.y=s,this.mag=_(t,s),this.startAngle=at(gt(s,t)),this.startX=t,this.startY=s,this.rotation=i,a(this,Y,F).call(this)}rotate(t){return this.rotation+=t,a(this,Y,F).call(this),this}rotateTo(t){return this.rotation=t,a(this,Y,F).call(this),this}draw(t,s=new l(0,0),i=new x(0,0,0),o=1){t.beginPath(),t.strokeStyle=i.toHex(),t.lineWidth=o,t.moveTo(s.x,s.y),t.lineTo(s.x+this.x,s.y+this.y),t.stroke(),t.closePath()}normalize(){return this.mag!=0&&(this.x/=this.mag,this.startX/=this.mag,this.y/=this.mag,this.startY/=this.mag,this.mag=1),this}multiply(t){return this.x*=t,this.startX*=t,this.y*=t,this.startY*=t,this.mag*=t,this}add(t){return this.x+=t.x,this.startX+=t.x,this.y+=t.x,this.startY+=t.x,a(this,p,v).call(this),this}multiplyX(t){return this.x*=t,this.startX*=t,a(this,p,v).call(this),this}multiplyY(t){return this.y*=t,this.startY*=t,a(this,p,v).call(this),this}divide(t){return this.x/=t,this.startX/=t,this.y/=t,this.startY/=t,this.mag/=t,this}appendMag(t){if(this.mag!=0){const s=this.mag+t;this.normalize(),this.multiply(s),this.mag=s}return this}appendX(t){return this.x+=t,this.startX+=t,a(this,p,v).call(this),this}appendY(t){return this.y+=t,this.startY+=t,a(this,p,v).call(this),this}setX(t){return this.x=t,this.startX=t,a(this,p,v).call(this),this}setY(t){return this.y=t,this.startY=t,a(this,p,v).call(this),this}setMag(t){return this.normalize(),this.multiply(t),this.mag=t,this}clone(){return new it(this.x,this.y,this.rotation)}format(){return`(${this.x}, ${this.y})`}};let X=it;Y=new WeakSet,F=function(){this.rotation=lt(this.rotation);const t=this.rotation*(Math.PI/180);this.x=this.startX*Math.cos(t)-this.startY*Math.sin(t),this.y=this.startX*Math.sin(t)+this.startY*Math.cos(t)},p=new WeakSet,v=function(){this.mag=_(this.x,this.y)};class k{constructor(t,s=new x(0,0,0)){this.pos=t,this.color=s,this.sim=null}setSimulationElement(t){this.sim=t}fill(t,s=0){const i=new x(this.color.r,this.color.g,this.color.b),o=t.clone(),h=(o.r-this.color.r)/(s*y),u=(o.g-this.color.g)/(s*y),d=(o.b-this.color.b)/(s*y),r=()=>{this.color=o};return V(r,()=>{i.r+=h,i.g+=u,i.b+=d,this.color.r=i.r,this.color.g=i.g,this.color.b=i.b},r,s)}moveTo(t,s=0){const i=(t.x-this.pos.x)/(s*y),o=(t.y-this.pos.y)/(s*y);return V(()=>{this.pos=t},()=>{this.pos.x+=i,this.pos.y+=o},()=>{this.pos.x=t.x,this.pos.y=t.y},s)}move(t,s=0){const i=t.x/(s*y),o=t.y/(s*y),h=new l(this.pos.x,this.pos.y);return V(()=>{this.pos.x+=t.x,this.pos.y+=t.y},()=>{this.pos.x+=i,this.pos.y+=o},()=>{this.pos.x=h.x+t.x,this.pos.y=h.y+t.y},s)}}var I,q;const nt=class{constructor(t,s,i){M(this,I);this.r=t,this.g=s,this.b=i}clone(){return new nt(this.r,this.g,this.b)}toHex(){return"#"+a(this,I,q).call(this,this.r)+a(this,I,q).call(this,this.g)+a(this,I,q).call(this,this.b)}};let x=nt;I=new WeakSet,q=function(t){const s=Math.round(t).toString(16);return s.length==1?"0"+s:s};class l extends X{constructor(t,s){super(t,s)}clone(){return new l(this.x,this.y)}}class et extends k{constructor(t=""){super(new l(0,0)),this.name=t,this.scene=[],this.idObjs={}}add(t,s=null){t instanceof k?(this.sim!=null&&t.setSimulationElement(this.sim),s!=null?this.idObjs[s]=t:this.scene.push(t)):console.warn("Invalid Element. Must be an instance of SimElement")}removeWithId(t){delete this.idObjs[t]}removeWithObject(t){for(const s of this.scene)if(s==t){this.scene.splice(this.scene.indexOf(s),1);return}for(const s of Object.keys(this.idObjs))if(this.idObjs[s]==t){delete this.idObjs[s];return}}setSimulationElement(t){this.sim=t;for(const s of this.scene)s.setSimulationElement(t)}draw(t){for(const s of this.scene)s.draw(t);for(const s of Object.values(this.idObjs))s.draw(t)}empty(){this.scene=[],this.idObjs={}}}var P,H;const ot=class extends k{constructor(s,i,o,h=0,u=new l(0,0)){super(s,o);M(this,P);this.rawPoints=i,this.offsetPoint=u,this.offsetX=this.offsetPoint.x,this.offsetY=this.offsetPoint.y,this.points=i.map(d=>new l(d.x+this.offsetX,d.y+this.offsetY)),this.rotation=h,a(this,P,H).call(this)}setPoints(s){this.points=s.map(i=>new l(i.x+this.offsetX,i.y+this.offsetY))}clone(){return new ot(this.pos,this.rawPoints,this.color,this.rotation,this.offsetPoint)}rotate(s){this.rotation+=s,a(this,P,H).call(this)}rotateTo(s){this.rotation=s,a(this,P,H).call(this)}draw(s){s.beginPath(),s.fillStyle=this.color.toHex(),s.moveTo(this.points[0].x+this.pos.x,this.points[0].y+this.pos.y);for(let i=1;i<this.points.length;i++)s.lineTo(this.points[i].x+this.pos.x,this.points[i].y+this.pos.y);s.fill(),s.closePath()}};let Q=ot;P=new WeakSet,H=function(){this.rotation=lt(this.rotation),this.points=this.points.map(s=>(s.rotateTo(this.rotation),s))};var N,Z,R,W;class mt{constructor(t,s=60){M(this,N);M(this,R);if(y=s,this.scene=[],this.idObjs={},this.fitting=!1,this.bgColor="#ffffff",this.canvas=document.getElementById(t),!this.canvas){console.warn(`Canvas with id "${t}" not found`);return}this.canvas.addEventListener("mousemove",o=>{new l(o.offsetX,o.offsetY)}),window.addEventListener("resize",()=>a(this,R,W).call(this,this.canvas)),a(this,R,W).call(this,this.canvas);const i=this.canvas.getContext("2d");a(this,N,Z).call(this,i)}add(t,s=null){t instanceof k?(t.setSimulationElement(this.canvas),s!==null?this.idObjs[s]=t:this.scene.push(t)):console.warn("Invalid Element. Must be an instance of SimElement")}removeWithId(t){this.idObjs[t]!==void 0&&delete this.idObjs[t]}removeWithObject(t){for(const s of this.scene)if(D(s,t)){this.scene.splice(this.scene.indexOf(s),1);return}for(const s of Object.keys(this.idObjs))D(this.idObjs[s],t)&&delete this.idObjs[s]}on(t,s){!this.canvas||this.canvas.addEventListener(t,s)}fitElement(){!this.canvas||(this.fitting=!0,a(this,R,W).call(this,this.canvas))}setSize(t,s){!this.canvas||(this.canvas.width=t,this.canvas.height=s,this.fitting=!1)}setBgColor(t){t instanceof x?this.bgColor=t.toHex():console.warn("Invalid color. Must be an instance of Color object")}empty(){this.scene=[],this.idObjs={}}}N=new WeakSet,Z=function(t){t.clearRect(0,0,this.canvas.width,this.canvas.height),t.beginPath(),t.fillStyle=this.bgColor,t.fillRect(0,0,this.canvas.width,this.canvas.height),t.closePath();for(const s of this.scene)s.draw(t);Object.values(this.idObjs).forEach(s=>{s.draw(t)}),window.requestAnimationFrame(()=>a(this,N,Z).call(this,t))},R=new WeakSet,W=function(t){!this.canvas||(this.fitting&&(t.width=t.parentElement.clientWidth,t.height=t.parentElement.clientHeight),this.width=this.canvas.width,this.height=this.canvas.height)};function _(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function rt(e,t){return _(e.x-t.x,e.y-t.y)}function gt(e,t){return Math.atan2(t,e)}function at(e){return e*180/Math.PI}function lt(e){for(;e>360;)e-=360;return e}function V(e,t,s,i){return new Promise((o,h)=>{if(i==0)e(),o();else{const u=i*y;let d=0;const r=()=>{t(),d<u?(d++,window.requestAnimationFrame(r)):(s(),o())};window.requestAnimationFrame(r)}})}function D(e,t){const s=[null,void 0];if(s.includes(e)||s.includes(t))return e===t;if(typeof e!=typeof t)return!1;if(Array.isArray(e)){for(let i=0;i<e.length;i++)if(!D(e[i],t[i]))return!1;return!0}if(typeof e=="object"){const i=(r,w,S)=>{for(let m=0;m<r.length;m++){if(typeof w[r[m]]!=typeof S[r[m]])return!1;if(typeof w[r[m]]=="object")return D(w[r[m]],S[r[m]]);if(w[r[m]]!==S[r[m]])return!1}return!0},o=Object.keys(e),h=Object.keys(t),u=i(o,e,t),d=i(h,e,t);return!!(u&&d)}return e===t}const f=new mt("canvas");f.fitElement();const pt=new et("lines");f.add(pt,"lines");const wt=new et("centers");f.add(wt,"centers");const tt=new et("boids");f.add(tt,"boids");class yt extends Q{constructor(t,s,i=0){super(new l(t,s),[new l(0,-8),new l(-4,8),new l(4,8)],new x(0,0,0),i,new l(0,-2))}}let j=300,c=1,$=2.5;$/=c;let T=.03,A=.095,B=.042,ct=.4;T/=c;A/=c;B/=c;ct/=c;document.getElementById("cohesionInput").value=T*c;document.getElementById("alignmentInput").value=A*c;document.getElementById("seperationInput").value=B*c;document.getElementById("numBoidsInput").value=j;document.getElementById("speedReductionInput").value=c;const b=8,xt=80,bt=35,vt=180,Ot=15;let n=ft(j);st(n);let K=!1,E=null;window.changeCohesion=e=>{T=e/c};window.changeAlignment=e=>{A=e/c};window.changeSeperation=e=>{B=e/c};window.changeNumBoids=e=>{if(j=e,n.length<j){const t=ft(j-n.length);n=[...n,...t],st(n)}if(n.length>j){const t=n.length-j;n.splice(n.length-t,n.length),st(n)}};window.changeSpeedReduction=e=>{T*=c,A*=c,B*=c,$*=c,c=e,T/=c,A/=c,B/=c,$/=c};window.toggleColors=()=>{if(K=!K,!K)for(let e=0;e<n.length;e++)n[e].fill(new x(0,0,0))};f.on("mousedown",e=>{E=new l(e.offsetX,e.offsetY)});f.on("mouseup",()=>{E=null});f.on("mousemove",e=>{E&&(E=new l(e.offsetX,e.offsetY))});function z(e,t){const s=new l(e.x-t.pos.x,e.y-t.pos.y);let i=at(Math.atan2(s.y,s.x))+90-t.rotation;return Math.abs(i)>180&&(i=(360-Math.abs(i))*(Math.sign(i)*-1)),i}function C(e){return Math.min(Math.abs(e),Ot)*Math.sign(e)}(function e(){for(let t=0;t<n.length;t++){let s=0,i=0,o=[],h=[],u=0;for(let g=0;g<n.length;g++){if(t===g)continue;const G=n[t].pos,U=n[g].pos,ht=rt(G,U);ht<xt&&(s+=U.x,i+=U.y,o.push(n[g]),u+=n[g].rotation),ht<bt&&h.push(n[g])}u/=o.length,s/=o.length,i/=o.length;const d=new X(s,i);let r=0,w=C(z(d,n[t])*T);w=isNaN(w)?0:w,r+=w;const S=new X(0,-1,u),m=new l(S.x+n[t].pos.x,S.y+n[t].pos.y);let L=C(z(m,n[t])*A);L=isNaN(L)?0:L,r+=L;let O=0;for(let g=0;g<h.length;g++){const G=-z(h[g].pos,n[t])*B;O+=G}O=C(O),O=isNaN(O)?0:O,r+=O,E&&rt(E,n[t].pos)<vt&&(r+=-C(z(E,n[t])*ct)),r=C(r),n[t].rotate(r);const ut=new X(0,1,n[t].rotation).multiply(-$);n[t].move(ut),K&&n[t].fill(new x(n[t].pos.x/f.canvas.width*255,n[t].pos.y/f.canvas.height*255,255-n[t].pos.x/f.canvas.width*255)),n[t].pos.x<-b?n[t].moveTo(new l(f.canvas.width+b,n[t].pos.y)):n[t].pos.x>f.canvas.width+b&&n[t].moveTo(new l(-b,n[t].pos.y)),n[t].pos.y<-b?n[t].moveTo(new l(n[t].pos.x,f.canvas.height+b)):n[t].pos.y>f.canvas.height+b&&n[t].moveTo(new l(n[t].pos.x,-b))}window.requestAnimationFrame(e)})();function st(e){tt.empty(),e.forEach(t=>tt.add(t))}function J(e){return Math.floor(Math.random()*e)}function ft(e){return Array(e).fill({}).map(()=>new yt(J(f.canvas.width),J(f.canvas.height),J(360)))}
